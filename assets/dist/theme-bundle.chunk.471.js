"use strict";(self.webpackChunkpapathemes_kitchenary=self.webpackChunkpapathemes_kitchenary||[]).push([[471],{30471:(t,e,r)=>{r.r(e),r.d(e,{default:()=>C});var n=r(4621),a=r(57792),o=r(13228),i=r(71779),c=r(27672),s=r(56526),d=r(88835),l=r(65117),u=(r(77462),r(41582)),h=r(28204),f=r(22599),p=r(28645),g=r(18729),v=r(33270);function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}var C=function(t){function e(e){var r;return(r=t.call(this,e)||this).validationDictionary=(0,i.i)(e),r}var r,a;a=t,(r=e).prototype=Object.create(a.prototype),r.prototype.constructor=r,y(r,a);var C=e.prototype;return C.formatCategoryTreeForJSTree=function(t){var e=this,r={text:t.data,id:t.metadata.id,state:{selected:t.selected}};return t.state&&(r.state.opened="open"===t.state,r.children=!0),t.children&&(r.children=[],t.children.forEach((function(t){r.children.push(e.formatCategoryTreeForJSTree(t))}))),r},C.showProducts=function(){var t=s.A.replaceParams(window.location.href,{section:"product"});this.$productListingContainer.removeClass("u-hiddenVisually"),this.$facetedSearchContainer.removeClass("u-hiddenVisually"),this.$contentResultsContainer.addClass("u-hiddenVisually"),v("[data-content-results-toggle]").removeClass("navBar-action-color--active"),v("[data-content-results-toggle]").addClass("navBar-action"),v("[data-product-results-toggle]").removeClass("navBar-action"),v("[data-product-results-toggle]").addClass("navBar-action-color--active"),s.A.goToUrl(t)},C.showContent=function(){var t=s.A.replaceParams(window.location.href,{section:"content"});this.$contentResultsContainer.removeClass("u-hiddenVisually"),this.$productListingContainer.addClass("u-hiddenVisually"),this.$facetedSearchContainer.addClass("u-hiddenVisually"),v("[data-product-results-toggle]").removeClass("navBar-action-color--active"),v("[data-product-results-toggle]").addClass("navBar-action"),v("[data-content-results-toggle]").removeClass("navBar-action"),v("[data-content-results-toggle]").addClass("navBar-action-color--active"),s.A.goToUrl(t)},C.onReady=function(){var t=this;(0,c.A)(this.context);var e=v("#product-listing-container").data("searchInfiniteScroll"),r=v("[data-advanced-search-form]"),a=r.find("[data-search-category-tree]"),o=d.parse(window.location.href,!0),i=[];this.$productListingContainer=v("#product-listing-container"),this.$facetedSearchContainer=v("#faceted-search-container"),this.$contentResultsContainer=v("#search-results-content"),this.context&&(this.context.show_bulk_order_mode||this.context.useBulkOrder)&&(this.bulkOrder=(0,f.A)(this.context)),(0,h.A)();var s={bulkOrder:this.bulkOrder,enableInfiniteScroll:e,txtLoadMore:this.context.txtLoadMore,insertTopPaginationFunc:function(t,e){return e.find(".productGrid").before(t)},insertBottomPaginationFunc:function(t,e){return e.find(".productGrid").after(t)}};v("#facetedSearch").length>0?(e&&(this.facetedInfiniteScroll=new p.q(s)),this.initFacetedSearch()):(this.onSortBySubmit=this.onSortBySubmit.bind(this),n.JL.on("sortBy-submitted",this.onSortBySubmit),e&&(this.standardInfiniteScroll=new p.x(Object.assign({requestOptions:{config:{product_results:{limit:this.context.searchProductsPerPage}},template:"search/product-listing"}},s)))),(0,l.Ay)(),v("[data-product-results-toggle]").on("click",(function(e){e.preventDefault(),t.showProducts()})),v("[data-content-results-toggle]").on("click",(function(e){e.preventDefault(),t.showContent()})),0===this.$productListingContainer.find("li.product").length||"content"===o.query.section?this.showContent():this.showProducts();var u=this.initValidation(r).bindValidation(r.find("#search_query_adv"));this.context.categoryTree.forEach((function(e){i.push(t.formatCategoryTreeForJSTree(e))})),this.categoryTreeData=i,this.createCategoryTree(a),r.on("submit",(function(t){var e=a.jstree().get_selected();if(!u.check())return t.preventDefault();r.find('input[name="category[]"]').remove();for(var n,i=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return m(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(n=i()).done;){var c=n.value,s=v("<input>",{type:"hidden",name:"category[]",value:c});r.append(s)}t.preventDefault();var d=r.serializeArray().filter((function(t){return t.value})).map((function(t){return t.name+"="+t.value})).join("&"),l=(r.attr("action")||o.pathname).concat(d?"?"+d:"");window.location=l}))},C.destroy=function(){this.facetedSearch?this.facetedSearch.destroy():n.JL.off("sortBy-submitted",this.onSortBySubmit)},C.loadTreeNodes=function(t,e){var r=this;v.ajax({url:"/remote/v1/category-tree",data:{selectedCategoryId:t.id,prefix:"category"},headers:{"x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""}}).done((function(t){var n=[];t.forEach((function(t){n.push(r.formatCategoryTreeForJSTree(t))})),e(n)}))},C.createCategoryTree=function(t){var e=this,r={core:{data:function(t,r){"#"===t.id?r(e.categoryTreeData):e.loadTreeNodes(t,r)},themes:{icons:!0}},checkbox:{three_state:!1},plugins:["checkbox"]};t.jstree(r),t.on("ready.jstree, redraw.jstree",(function(){return t.find(".jstree-node").removeAttr("aria-selected")})),t.on("changed.jstree",(function(t,e){e.event&&v(e.event.currentTarget.closest(".jstree-node")).removeAttr("aria-selected")}))},C.initFacetedSearch=function(){var t=this,e=this.validationDictionary,r=e.price_min_evaluation,n=e.price_max_evaluation,a=e.price_min_not_entered,i=e.price_max_not_entered,c=e.price_invalid_value,s=v("#product-listing-container"),d=v("#faceted-search-container"),l=v("#search-results-heading"),u=v("#search-results-product-count"),h={template:{productListing:"search/product-listing",sidebar:"search/sidebar",heading:"search/heading",productCount:"search/product-count"},config:{product_results:{limit:this.context.searchProductsPerPage}},showMore:"search/show-more"};this.facetedSearch=new o.A(h,(function(e,r){if(t.facetedInfiniteScroll)return t.facetedInfiniteScroll.refreshView(e,r,t.context);s.html(e.productListing),d.html(e.sidebar),l.html(e.heading),u.html(e.productCount),s.find("img[data-no-img]").attr("src",""+t.context.defaultProductImage),v("body").triggerHandler("compareReset"),t.bulkOrder&&t.bulkOrder.reinit(),(0,g.GO)()}),{validationErrorMessages:{onMinPriceError:r,onMaxPriceError:n,minPriceNotEntered:a,maxPriceNotEntered:i,onInvalidPrice:c}})},C.initValidation=function(t){return this.$form=t,this.validator=(0,u.A)({submit:t}),this},C.bindValidation=function(t){return this.validator&&this.validator.add({selector:t,validate:"presence",errorMessage:t.data("errorMessage")}),this},C.check=function(){return!!this.validator&&(this.validator.performCheck(),this.validator.areAll("valid"))},e}(a.A)}}]);
//# sourceMappingURL=theme-bundle.chunk.471.js.map