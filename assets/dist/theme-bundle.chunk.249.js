"use strict";(self.webpackChunkpapathemes_kitchenary=self.webpackChunkpapathemes_kitchenary||[]).push([[249],{81249:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var i=r(4621),o=r(57792),a=r(27672),n=r(13228),s=r(71779),c=r(28204),h=r(22599),d=r(38221),l=r.n(d),u=r(88835),g=r(56526),p=r(33270),f=function(){function e(e){this.doSearch=l()(this.doSearch.bind(this),500),this.onInput=this.onInput.bind(this),this.onFormSubmit=this.onFormSubmit.bind(this),this.onClear=this.onClear.bind(this),this.onStateChange=this.onStateChange.bind(this),this.options=e,this.$body=p("body"),this.$input=p("[data-search-in-category]"),this.$form=this.$input.closest("form"),this.$clear=this.$form.find("[data-clear]").hide(),this.originalPathname=window.location.pathname,e&&e.facetedSearch&&(this.options.facetedSearch.updateViewCallback=this.updateViewFacetedSearch.bind(this)),this.bindEvents();var t=u.parse(g.A.getUrl(),!0);t.query.q&&(this.$input.val(t.query.q),this.$clear.show(),p(window).trigger("statechange"))}var t=e.prototype;return t.destroy=function(){this.unbindEvents()},t.bindEvents=function(){this.$input.on("input",this.onInput),this.$form.on("submit",this.onFormSubmit),this.$clear.on("click",this.onClear),0===p("#facetedSearch").length&&p(window).on("statechange",this.onStateChange)},t.unbindEvents=function(){this.$input.off("input",this.onInput),this.$form.off("submit",this.onFormSubmit),this.$clear.off("click",this.onClear),p(window).off("statechange",this.onStateChange)},t.onFormSubmit=function(){return!1},t.onClear=function(e){e.preventDefault(),this.$clear.hide(),this.$input.val("").trigger("input")},t.onInput=function(e){this.doSearch(p(e.target).val())},t.onStateChange=function(){var e=this,t=g.A.getUrl(),r=g.A.getUrl(),o=u.parse(r,!0),a=o.query.search_query||o.query.search_query_adv||o.query.q,n={template:{productListing:"category/product-listing",sidebar:"category/sidebar"},config:{category:{shop_by_price:!0}}};a&&(o.query.search_query_adv=a,delete o.query.search_query,delete o.query.q,delete o.query.category,this.options.context.categoryId?o.query["category[]"]=this.options.context.categoryId:delete o.query["category[]"],this.options.context.categorypage_search_subs&&(o.query.searchsubs="ON"),r="/search.php?"+g.A.buildQueryString(o.query),n={template:{productListing:"supermarket/search-in-category/product-listing",sidebar:"supermarket/search-in-category/sidebar"},showMore:"search/show-more"}),this.$form.addClass("loading"),this.$body.trigger("beforerequest.searchincategory"),i.FH.getPage(r,n,(function(r,i){if(e.$form.removeClass("loading"),r)throw new Error(r);e.$body.trigger("beforeupdate.searchincategory"),i&&e.options.searchCallback&&e.options.searchCallback(i,t),e.$body.trigger("afterupdate.searchincategory")}))},t.doSearch=function(e){if(0===e.length){this.$clear.hide();var t=g.A.removeParams(g.A.getUrl(),["q","search_query","search_query_adv","category","page"]);g.A.goToUrl(t)}else if(e.length>=3){this.$clear.show();var r=g.A.removeParams(g.A.getUrl(),["q","search_query","search_query_adv","page"]);r=g.A.replaceParams(r,{q:e}),g.A.goToUrl(r)}},t.updateViewFacetedSearch=function(){var e=this,t=this.options.facetedSearch,r=g.A.getUrl(),o=g.A.getUrl(),a=t.requestOptions,n=u.parse(o,!0),s=n.query.q||n.query.search_query,c=["_bc_fsnf","search_query","q","sort","limit","mode","page"],h=Object.keys(n.query).filter((function(e){return-1===c.indexOf(e)}));"/search.php"===window.location.pathname&&0===h.length?(this.$input.val(""),this.$clear.hide(),o=g.A.removeParams(o,[].concat(h,["search_query","q","_bc_fsnf"])).replace("/search.php",this.originalPathname),window.history.replaceState({},document.title,o)):s?("/search.php"===window.location.pathname&&(n.query.q=s,delete n.query.search_query,Number(n.query.category)===this.options.context.categoryId&&delete n.query.category,window.history.replaceState({},document.title,this.originalPathname+"?"+g.A.buildQueryString(n.query))),delete n.query.q,n.query.search_query=s,n.query.category||(n.query.category=this.options.context.categoryId),o="/search.php?"+g.A.buildQueryString(n.query),a={template:{productListing:"supermarket/search-in-category/product-listing",sidebar:"supermarket/search-in-category/sidebar"},showMore:"search/show-more"}):this.$input.val(""),p(t.options.blockerSelector).show(),this.$form.addClass("loading"),this.$body.trigger("beforerequest.searchincategory"),i.FH.getPage(o,a,(function(i,o){if(p(t.options.blockerSelector).hide(),e.$form.removeClass("loading"),i)throw new Error(i);if(null!=o&&o.sidebar){var a=p(t.options.accordionToggleSelector).get().map((function(e){var t;return null==(t=p(e).data("collapsibleInstance"))?void 0:t.targetId})).filter((function(e){return e}));p(o.sidebar).find(t.options.accordionToggleSelector).each((function(e,r){var i=p(r),o=i.data("collapsible").replace("#","");i.not(".is-open")&&!a.includes(o)&&t.collapsedFacets.push(o)}))}e.$body.trigger("beforeupdate.searchincategory"),t.refreshView(o,r),e.$body.trigger("afterupdate.searchincategory")}))},e}(),y=r(23814),m=r(28645),b=r(28797),_=r(18729),v=r(33270);function q(e,t){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},q(e,t)}var S=(0,b.A)("large"),w=function(e){function t(t){var r;return(r=e.call(this,t)||this).validationDictionary=(0,s.i)(t),r}var r,o;o=e,(r=t).prototype=Object.create(o.prototype),r.prototype.constructor=r,q(r,o);var d=t.prototype;return d.onReady=function(){var e=v("#product-listing-container").data("categoryInfiniteScroll");this.context&&(this.context.show_bulk_order_mode||this.context.useBulkOrder)&&(this.bulkOrder=(0,h.A)(this.context)),(0,a.A)(this.context);var t={bulkOrder:this.bulkOrder,enableInfiniteScroll:e,txtLoadMore:this.context.txtLoadMore,insertTopPaginationFunc:function(e,t){return t.find(".productGrid").before(e)},insertBottomPaginationFunc:function(e,t){return t.find(".productGrid").after(e)}};v("#facetedSearch").length>0?(e&&(this.facetedInfiniteScroll=new m.q(t)),this.initFacetedSearch()):(this.onSortBySubmit=this.onSortBySubmit.bind(this),i.JL.on("sortBy-submitted",this.onSortBySubmit),(0,y.A)(),"show"===this.context.categorypage_search&&v("body").on("afterupdate.searchincategory",(function(){return(0,y.A)()})),e&&(this.standardInfiniteScroll=new m.x(Object.assign({requestOptions:{config:{category:{products:{limit:this.context.categoryProductsPerPage}}},template:"category/product-listing"}},t)))),(0,c.A)(),"show"===this.context.categorypage_search&&this.initSearchInCategory(),v("#categories-navList .navList-action--checkbox").on("click",(function(e){return v(e.target).toggleClass("is-selected")})),v("#subCategories-loadMore").on("click",(function(e){var t=v(e.target),r=t.data("show-more"),i=t.data("show-less");t.hasClass("_showMore-off")?t.removeClass("_showMore-off").text(i).attr("aria-label",i).siblings(".subCategories-list").toggleClass("_showMore"):t.addClass("_showMore-off").text(r).attr("aria-label",r).siblings(".subCategories-list").toggleClass("_showMore")}));var r=function(){var e=v("#papathemes-productsFilter-form");S.matches?(v('.form-radio[value="2"]',e).css("display","inline-block"),v('.form-radio[value="2"] + label.form-option',e).css("display","inline-flex")):(v(".form-radio",e).each((function(t,r){v(r).prop("checked")&&("mode_1_main"===v(r).attr("id")||"mode_2_main"===v(r).attr("id")||"mode_bo_main"===v(r).attr("id")?(v('.form-radio[value="2"]',e).css("display","inline-block"),v('.form-radio[value="2"] + label.form-option',e).css("display","inline-flex")):(v('.form-radio[value="2"]',e).css("display","none"),v('.form-radio[value="2"] + label.form-option',e).css("display","none")))})),v(".form-radio",e).on("change",(function(t){var r=v(t.target);"mode_1_main"!==r.attr("id")&&"mode_2_main"!==r.attr("id")&&"mode_bo_main"!==r.attr("id")||(v('.form-radio[value="2"]',e).css("display","inline-block"),v('.form-radio[value="2"] + label.form-option',e).css("display","inline-flex"))})))};r(),S.addListener(r)},d.destroy=function(){this.searchInCategory&&this.searchInCategory.destroy(),this.facetedSearch?this.facetedSearch.destroy():i.JL.off("sortBy-submitted",this.onSortBySubmit)},d.initSearchInCategory=function(){var e=this;this.searchInCategory=new f({context:this.context,facetedSearch:this.facetedSearch,searchCallback:function(t,r){if(e.standardInfiniteScroll)return e.standardInfiniteScroll.refreshView(t,r);v("#product-listing-container").html(t.productListing),e.bulkOrder&&e.bulkOrder.reinit(),(0,c.A)(),v("body").triggerHandler("compareReset"),(0,_.GO)()}})},d.initFacetedSearch=function(){var e=this,t=this.validationDictionary,r=t.price_min_evaluation,i=t.price_max_evaluation,o=t.price_min_not_entered,a=t.price_max_not_entered,s=t.price_invalid_value,c=v("#product-listing-container"),h=v("#faceted-search-container"),d={config:{category:{shop_by_price:!0,products:{limit:this.context.categoryProductsPerPage}}},template:{productListing:"category/product-listing",sidebar:"category/sidebar"},showMore:"category/show-more"};this.facetedSearch=new n.A(d,(function(t,r){if(e.facetedInfiniteScroll)return e.facetedInfiniteScroll.refreshView(t,r);c.html(t.productListing),h.html(t.sidebar),e.bulkOrder&&e.bulkOrder.reinit(),v("body").triggerHandler("compareReset"),(0,_.GO)()}),{validationErrorMessages:{onMinPriceError:r,onMaxPriceError:i,minPriceNotEntered:o,maxPriceNotEntered:a,onInvalidPrice:s}})},t}(o.A)}}]);
//# sourceMappingURL=theme-bundle.chunk.249.js.map
